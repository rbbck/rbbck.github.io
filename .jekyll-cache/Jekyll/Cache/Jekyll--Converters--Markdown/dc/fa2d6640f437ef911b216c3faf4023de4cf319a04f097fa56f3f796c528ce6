I"£1<p><img src="/assets/Pasted image 20220627235902.png" alt="" /></p>

<h1 id="primeiros-passos">Primeiros passos</h1>
<p>Esta room Ã© pensada para testar uma variedade de tÃ©cnicas de <strong>OSINT</strong><sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>, vamos experienciar um exemplo de <strong>investigaÃ§Ã£o</strong> que visa <strong>achar alguns identificadores</strong> e outros <strong>pedaÃ§os de informaÃ§Ãµes</strong> afim de capturar um cibercriminoso.</p>

<blockquote>
  <p>NOTE: All answers can be obtained via passive OSINT techniques, DO NOT attempt any active techniques such as reaching out to account owners, password resets, etc to solve these challenges.</p>
</blockquote>

<p>TambÃ©m somos avisados de que nenhum <strong>OSINT ativo</strong> serÃ¡ necessÃ¡rio. Veja a seguir <strong>alguns</strong> exemplos para distingui-los:</p>

<table>
  <thead>
    <tr>
      <th>OSINT Passivo</th>
      <th>OSINT Ativo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NÃ£o faz contato direto</td>
      <td>Pode ocorrer contato entre os lados</td>
    </tr>
    <tr>
      <td>Scans passivos, mais oculto</td>
      <td>Postura mais agressiva e intrusiva, maior risco de detecÃ§Ã£o</td>
    </tr>
    <tr>
      <td>Juntar informaÃ§Ãµes disponÃ­veis hospedadas em terceiros</td>
      <td>Engenharia social, ex: enviar um link malicioso para vÃ­tima</td>
    </tr>
  </tbody>
</table>

<hr />

<h1 id="primeira-flag">Primeira flag</h1>
<blockquote>
  <p>What username does the attacker go by?</p>
</blockquote>

<p>Nos Ã© pedido o <strong>nome de usuÃ¡rio</strong> do criminoso. AlÃ©m disso, Ã© fornecido um panorama:</p>
<blockquote>
  <p>O <a href="https://www.osintdojo.com">OSINT Dojo</a> foi vÃ­tima de um ciberataque e durante anÃ¡lises forenses, foi encontrada uma imagem deixada para trÃ¡s pelo autor do crime. Quem sabe ela contÃ©m alguma pista que nos permitiria apontar uma direÃ§Ã£o?</p>
</blockquote>

<p><img src="/assets/Pasted image 20220628011354.png" alt="" /></p>

<p>Com isso temos nosso ponto de partida. Em uma imagem podem haver inÃºmeras informaÃ§Ãµes escondidas, seja porque <a href="https://www.gta.ufrj.br/ensino/eel878/redes1-2016-1/16_1/esteganografia/">alguÃ©m escondeu</a>  lÃ¡, ou, como no nosso caso, porque alguÃ©m <strong>esqueceu de checar o prÃ³prio rastro</strong>. O <strong><em>Exchangeable image file format</em></strong> ou simplesmente <strong>EXIF</strong> Ã© um <strong>padrÃ£o para armazenar informaÃ§Ãµes na fotografia digital</strong>. Resumidamente, Ã© um conjunto de informaÃ§Ãµes sobre (e contidas em) uma imagem, tais como sua <strong>resoluÃ§Ã£o</strong>, <strong>data de modificaÃ§Ã£o</strong>, <strong>fabricante da cÃ¢mera</strong>, etc. Em alguns casos, pode conter atÃ© mesmo dados de <strong>geolocalizaÃ§Ã£o</strong>.</p>

<p>Iremos utilizar a ferramenta <a href="https://exiftool.org/">ExifTool</a>, que serve para ler, gravar e editar <strong>metadados</strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exiftool sakurapwnedletter.svg
ExifTool Version Number Â Â Â Â Â Â Â Â : 12.42  
File Name Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : sakurapwnedletter.svg  
Directory Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : .  
File Size Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 850 kB  
File Modification Date/Time Â Â Â Â : 2022:06:28 01:28:26-03:00  
File Access Date/Time Â Â Â Â Â Â Â Â Â Â : 2022:06:28 01:28:26-03:00  
File Inode Change Date/Time Â Â Â Â : 2022:06:28 01:28:26-03:00  
File Permissions Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : -rw-r--r--  
File Type Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : SVG  
File Type Extension Â Â Â Â Â Â Â Â Â Â Â Â : svg  
MIME Type Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : image/svg+xml  
Xmlns Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : http://www.w3.org/2000/svg  
Image Width Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 116.29175mm  
Image Height Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 174.61578mm  
View Box Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 0 0 116.29175 174.61578  
SVG Version Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 1.1  
ID Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : svg8  
Version Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 0.92.5 (2060ec1f9f, 2020-04-08)  
Docname Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : pwnedletter.svg  
Export-filename Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : /home/SakuraSnowAngelAiko/Desktop/pwnedletter.png  
Export-xdpi Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 96  
Export-ydpi Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : 96  
Metadata ID Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : metadata5  
Work Format Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : image/svg+xml  
Work Type Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : http://purl.org/dc/dcmitype/StillImage  
Work Title Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â :
</code></pre></div></div>

<p>Temos inÃºmeras saÃ­das aqui, mas vamos focar em uma especÃ­fica. <strong>Export-filename</strong> possui como valor o caminho do arquivo na hora de sua exportaÃ§Ã£o:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Export-filename Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : /home/SakuraSnowAngelAiko/Desktop/pwnedletter.png
</code></pre></div></div>
<p>E com isso descobrimos o nome de usuÃ¡rio do nosso atacante.</p>

<hr />

<h1 id="segunda-flag">Segunda flag</h1>
<blockquote>
  <p>What is the full email address used by the attacker?</p>
</blockquote>

<p>Para o <strong>email do atacante</strong>, tanto Ã© vÃ¡lido utilizar uma ferramenta automatizada quanto ir diretamente nos sites e redes sociais mais conhecidos e inserir o nome de usuÃ¡rio que encontramos antes, ou seja, uma <strong>abordagem manual</strong>.</p>

<p>Uma <strong>Ã³tima ferramenta</strong> Ã© o <a href="https://github.com/sherlock-project/sherlock">Sherlock</a>, escrita em <strong>Python</strong>, que fornecido um nome de usuÃ¡rio, o software irÃ¡ atrÃ¡s dele por diversos locais na internet.</p>

<p>Exemplo de utilizaÃ§Ã£o:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 sherlock.py --verbose SakuraSnowAngelAiko

[*] Checking username SakuraSnowAngelAiko on:  
  
  
[+] [5058ms] GitHub: https://www.github.com/SakuraSnowAngelAiko  
[+] [11563ms] Reddit: https://www.reddit.com/user/SakuraSnowAngelAiko
[...]
</code></pre></div></div>

<p>Uma das saÃ­das Ã© o <strong>GitHub</strong> dele, o que nos Ã© muitÃ­ssimo interessante:</p>

<p><img src="/assets/Pasted image 20220628232728.png" alt="" /></p>

<p>Estes sÃ£o os <strong>repositÃ³rios fixados</strong> do nosso atacante:</p>

<p><img src="/assets/Pasted image 20220628233553.png" alt="" /></p>

<p>Um destaque especial para o repositÃ³rio <strong>PGP</strong><sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>, onde o invasor compartilha sua <strong>chave pÃºblica</strong><sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>.</p>

<p><img src="/assets/Pasted image 20220629014758.png" alt="" /></p>

<p>Se baixarmos a chave, rodarmos o <a href="https://gnupg.org/">gnu</a> <strong>sem fornecer nenhum parÃ¢metro</strong>, passando a <strong>publickey que baixamos</strong>, o programa vai â€œ<strong>printar</strong>â€ a chave:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://github.com/sakurasnowangelaiko/PGP/blob/main/publickey
gpg publickey

gpg: WARNING: no command supplied. Â Trying to guess what you mean ...  
pub Â Â rsa3072 2021-01-23 [SC] [expires: 2023-01-22]  
Â Â Â Â Â A6519F273BF88E9126B0F4C5ECDD0FD294110450  
uid Â Â Â Â Â Â Â Â Â Â SakuraSnowAngel83@protonmail.com  
sub Â Â rsa3072 2021-01-23 [E] [expires: 2023-01-22]
</code></pre></div></div>

<p>Revelando o <strong>email de nosso ciberpirata</strong>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uid Â Â Â Â Â Â Â Â Â Â SakuraSnowAngel83@protonmail.com  
</code></pre></div></div>

<hr />

<h1 id="terceira-flag">Terceira flag</h1>
<blockquote>
  <p>What is the attackerâ€™s full real name?</p>
</blockquote>

<p>Essa foi mamÃ£o com aÃ§Ãºcar! Jogando o <strong>nickname</strong> do GitHub no Google, <strong>nosso primeiro resultado jÃ¡ nos dÃ¡ a resposta</strong>, <strong>seu nome</strong>:</p>

<p><img src="/assets/Pasted image 20220629030444.png" alt="" /></p>

<p><img src="/assets/Pasted image 20220629030620.png" alt="" /></p>

<hr />

<h1 id="quarta-flag">Quarta flag</h1>
<blockquote>
  <p>What cryptocurrency does the attacker own a cryptocurrency wallet for?</p>
</blockquote>

<p>Nosso objetivo agora Ã© descobrir qual <strong>criptomoeda</strong> o Aiko movimenta. VocÃªs lembram dos repositÃ³rios de nosso <em>software engineer</em>?</p>

<p>Se reparar, os fixados somam apenas <strong>cinco</strong>, quando na realidade ele tem <strong>nove</strong>:</p>

<p><img src="/assets/Pasted image 20220629032530.png" alt="" /></p>

<p>Sendo um deles chamado â€œETHâ€, acrÃ´nimo para â€œ<a href="https://ethereum.org/en/">Ethereum</a>â€, uma das <strong>criptomoedas</strong> mais famosas:</p>

<p><img src="/assets/Pasted image 20220629032858.png" alt="" /></p>

<p>Inserindo <strong>ETH</strong> no TryHackMe, a resposta foi aceita, todavia, outros repositÃ³rios podem indicar que ele tambÃ©m utilizaria <strong>Litecoin</strong> e <strong>Bitcoin</strong>.</p>

<hr />

<h1 id="quinta-flag">Quinta flag</h1>
<blockquote>
  <p>What is the attackerâ€™s cryptocurrency wallet address?</p>
</blockquote>

<p>Para encontrar o <strong>endereÃ§o da carteira</strong> do hacker, precisaremos voltar no tempo.
Mas calma, que nÃ£o precisaremos do <strong>DeLorean</strong> nÃ£o!</p>

<p>DÃªem uma olhada na pÃ¡gina do repositÃ³rio <strong>ETH</strong>:</p>

<p><img src="/assets/Pasted image 20220629033224.png" alt="" /></p>

<p>Nota-se que <strong>dois</strong> <strong><em>commits</em></strong> foram feitos. Vamos ver o que foi alterado? Clicando no reloginho vemos:</p>

<p><img src="/assets/Pasted image 20220629033630.png" alt="" /></p>

<p>E ao clicar para ver o <em>commit</em> â€œUpdate miningscriptâ€:</p>

<p><img src="/assets/Pasted image 20220629033717.png" alt="" /></p>

<p>Ã‰ isso mesmo! O <strong>endereÃ§o de sua carteira digital</strong> sendo ocultada.</p>

<hr />

<h1 id="sexta-flag">Sexta flag</h1>
<blockquote>
  <p>What mining pool did the attacker receive payments from on January 23, 2021 UTC?</p>
</blockquote>

<p>Inserindo a nossa <strong>flag anterior</strong> no <a href="https://etherscan.io/">Etherscan</a>:</p>

<p><img src="/assets/Pasted image 20220629034349.png" alt="" /></p>

<p>Descobrimos que de fato a carteira existe:</p>

<p><img src="/assets/Pasted image 20220629034431.png" alt="" /></p>

<p>Agora sÃ³ precisamos ir atÃ© as <strong>transaÃ§Ãµes da carteira</strong> e procurar <strong>quem efetuou pagamentos</strong> para este destino <strong>no dia 23 de Janeiro de 2021</strong> como pede a flag:</p>

<p><img src="/assets/Pasted image 20220629034918.png" alt="" />
Desvendamos mais esta! O remetente desta transaÃ§Ã£o foi â€œ<strong>Ethermine</strong>â€.</p>

<hr />

<h1 id="sÃ©tima-flag">SÃ©tima flag</h1>
<blockquote>
  <p>What other cryptocurrency did the attacker exchange with using their cryptocurrency wallet?</p>
</blockquote>

<p>Qual outra <strong>criptomoeda</strong> o nosso alvo utilizou?
Ainda na pÃ¡gina das transaÃ§Ãµes nÃ³s encontramos esta resposta:</p>

<p><img src="/assets/Pasted image 20220629040200.png" alt="" /></p>

<p><strong>Tether</strong>! Uma <strong>criptomoeda</strong> que se compromete a ter uma proporÃ§Ã£o 1:1 em sua cotaÃ§Ã£o com o <strong>dÃ³lar estadunidense</strong></p>

<hr />
<blockquote>
  <p>Under construction</p>
  <pre class=""> ______
|_,.,--\
   ||
   ||
   ##
   ##</pre>
</blockquote>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p><em>Open Source Intelligence</em>Â <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><em>Pretty Good Privacy</em>Â <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p>Ler sobre <a href="https://pt.wikipedia.org/wiki/Criptografia_de_chave_p%C3%BAblica">criptografia de chave pÃºblica</a>.Â <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
:ET